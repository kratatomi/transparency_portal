{% extends "base.html" %}

{% block app_content %}
<script src="static/ethers-v4.min.js"
        type="application/javascript"></script>
<script src="static/app.js" type="application/javascript"></script>
<div class="container">
  <H2>SmartIndex proposals:</H2>
  <H3>Proposals along the information for voting can be found in the <a href="https://smartindex.cash/news-proposals/">News & Proposals</a> section of SmartIndex website.</H3>
    <H4>To vote, read carefully <a href="https://smartindex.cash/blog/2021/12/04/how-to-vote-using-checkbook-cash/">the voting guide</a>.</H4>
</div>

<div class="container" align="right">
    <div id="msg" class="alert alert-primary"></div>
    {% if not current_user.is_authenticated %}
        <br><button class="btn btn-primary" id="login" disabled onclick='login()'>Log In</button>
    {% endif %}
</div>

<br>

{% with messages=get_flashed_messages() %}
    {% if messages %}
            {% for message in messages %}
             <div class="alert alert-error">{{ message|safe }}</div>
            {% endfor %}
    {% endif %}
{% endwith %}

{% for proposal in proposals %}
<div class="list-group">
  <a href="#" class="list-group-item list-group-item-action flex-column align-items-start active">
    <div class="d-flex w-100 justify-content-between">
      <h5 class="mb-1">Proposal #{{ proposal.id }}</h5>
        {% if proposal.open %}
        <b><p style="color:rgb(0,200,0);">Open</p></b>
        {% else %}
            <b><p style="color:rgb(250,0,0);">Closed</p></b>
            <H3><p class="text-right">Final result:</p></H3>
            <H3><p class="text-right">{{ proposal.result }}</p></H3>
        {% endif %}
    </div>
      <p class="mb-1"><b>Proposal description:</b> {{ proposal.proposal }}</p>
      <small><b>Author:</b> {{ proposal.proposal_author }}</small>
      <small><b>Start date:</b> {{ proposal.start_time }} - <b>Deadline:</b> {{ proposal.end_time }} UTC Time</small>
  </a>
  {% if proposal.option_a_tag %}
          <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1">{{ proposal.option_a_tag }}</h5>
            </div>
            <p class="mb-1">{{ proposal.option_a_votes }} [OPTION: A]</p>
          </a>
  {% endif %}
  {% if proposal.option_b_tag %}
          <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1">{{ proposal.option_b_tag }}</h5>
            </div>
            <p class="mb-1">{{ proposal.option_b_votes }} [OPTION: B]</p>
          </a>
  {% endif %}
    {% if proposal.option_c_tag %}
          <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1">{{ proposal.option_c_tag }}</h5>
            </div>
            <p class="mb-1">{{ proposal.option_c_votes }} [OPTION: C]</p>
          </a>
  {% endif %}
            <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1">REJECT</h5>
            </div>
            <p class="mb-1">{{ proposal.reject_votes }} [OPTION: {{ proposal.reject_option }}]</p>
          </a>
</div>
{% endfor %}
<hr>
<div class="container" align="center">
    {% if prev_url %}
        <div style="display: inline-block"><a href="{{ prev_url }}" class="badge"><h5>Newer proposals</h5></a></div>
    {% endif %}
    {% if next_url %}
        <div style="display: inline-block"><a href="{{ next_url }}" class="badge"><h5>Older proposals</h5></a></div>
    {% endif %}
</div>
<br>
{% endblock %}